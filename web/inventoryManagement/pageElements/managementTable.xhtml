<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core">
    <div onload="#{manageTable.findAll()}">
        <h:form id="accountManagementForm">
            <div style="display:flex; padding-top: 0px; justify-content: flex-start">
                <div style="display:flex; align-items: center; padding-bottom: 10px">
                    <h:outputText class="font-medium" value="Search:"/>
                    <div style="padding-left: 1.5vw"/>
                    <p:inputText id="smartSearch" style="width: 50vw" value="#{manageTable.searchField}"  onkeydown="if (event.keyCode === 13) {
                        smartSearch();        
                        return false;
                            }"/>
                    <div style="padding-left: 1.5vw"/>
                    <p:commandButton value="Search" action="#{manageTable.smartSearch()}" style="width: 15%!important; align-self: flex-start" update="inventoryTable" styleClass="basic-buttons">
                    </p:commandButton>
                    <p:remoteCommand name="addBarcode" action="#{manageTable.smartSearch()}" update="inventoryTable"/>
                </div>
            </div>
            <p:dataTable id="inventoryTable" var="itemType" value="#{manageTable.displayedItems}" scrollable="true">
                <f:facet name="header">  
                    <h:outputText value="Inventory"/>  
                </f:facet>
                <p:subTable var="item" value="#{itemType.items}"> 
                    <f:facet name="header">  
                        <h:outputText value="#{itemType.typeName}"/>    
                    </f:facet>
                    <p:columnGroup type="header">
                        <p:row>
                            <p:column headerText="Barcode" />
                            <p:column headerText="Condition" />
                            <p:column headerText="Status" />
                            <p:column rendered="#{manageTable.columnRendered(0)}" headerText="#{itemType.findAttributeNames(0)}" /> 
                            <p:column rendered="#{manageTable.columnRendered(1)}"  headerText="#{itemType.findAttributeNames(1)}" />  
                            <p:column rendered="#{manageTable.columnRendered(2)}"  headerText="#{itemType.findAttributeNames(2)}" />  
                            <p:column rendered="#{manageTable.columnRendered(3)}"  headerText="#{itemType.findAttributeNames(3)}" />  
                            <p:column rendered="#{manageTable.columnRendered(4)}"  headerText="#{itemType.findAttributeNames(4)}" />  
                            <p:column rendered="#{manageTable.columnRendered(5)}"  headerText="#{itemType.findAttributeNames(5)}" />  
                            <p:column rendered="#{manageTable.columnRendered(6)}"  headerText="#{itemType.findAttributeNames(6)}" />  
                            <p:column rendered="#{manageTable.columnRendered(7)}"  headerText="#{itemType.findAttributeNames(7)}" />  
                            <p:column rendered="#{manageTable.columnRendered(8)}"  headerText="#{itemType.findAttributeNames(8)}" />  
                            <p:column rendered="#{manageTable.columnRendered(9)}"  headerText="#{itemType.findAttributeNames(9)}" />    
                        </p:row>
                    </p:columnGroup>

                    <p:column>  
                        <h:outputText value="#{item.barcode}"/>  
                    </p:column>
                    <p:column>  
                        <h:outputText value="#{item.condition}"/>  
                    </p:column>
                    <p:column>  
                        <h:outputText value="#{item.status}"/>  
                    </p:column>
                    <p:column rendered="#{manageTable.columnRendered(0)}">  
                        <h:outputText value="#{item.findPrimaryValue(0)}"/>  
                    </p:column>
                    <p:column rendered="#{manageTable.columnRendered(1)}">  
                        <h:outputText value="#{item.findPrimaryValue(1)}"/>  
                    </p:column> 
                    <p:column rendered="#{manageTable.columnRendered(2)}">  
                        <h:outputText value="#{item.findPrimaryValue(2)}"/>  
                    </p:column> 
                    <p:column rendered="#{manageTable.columnRendered(3)}">  
                        <h:outputText value="#{item.findPrimaryValue(3)}"/>  
                    </p:column> 
                    <p:column rendered="#{manageTable.columnRendered(4)}">
                        <h:outputText value="#{item.findPrimaryValue(4)}"/>  
                    </p:column> 
                    <p:column rendered="#{manageTable.columnRendered(5)}">  
                        <h:outputText value="#{item.findPrimaryValue(5)}"/>  
                    </p:column> 
                    <p:column rendered="#{manageTable.columnRendered(6)}">  
                        <h:outputText value="#{item.findPrimaryValue(6)}"/>  
                    </p:column> 
                    <p:column rendered="#{manageTable.columnRendered(7)}">  
                        <h:outputText value="#{item.findPrimaryValue(7)}"/>  
                    </p:column> 
                    <p:column rendered="#{manageTable.columnRendered(8)}">  
                        <h:outputText value="#{item.findPrimaryValue(8)}"/>  
                    </p:column> 
                    <p:column rendered="#{manageTable.columnRendered(9)}">  
                        <h:outputText value="#{item.findPrimaryValue(9)}"/>  
                    </p:column> 
                </p:subTable>  
                <f:facet name="footer">
                    <div style="display:flex; justify-content: flex-start">
                        <p:commandButton actionListener="#{navigator.setAccountIndex(1)}" ajax="false" value="Add" styleClass="basic-buttons">
                            <f:ajax render=":accounts"/>
                        </p:commandButton>
                        <p:commandButton action="#{navigator.setAccountIndex(accountsController.editAccountSelected())}" ajax="false" value="Edit" styleClass="basic-buttons">
                            <f:ajax render=":accounts"/>
                        </p:commandButton>
                        <p:commandButton action="#{accountsController.deleteAccount()}" ajax="false" value="Delete" styleClass="basic-buttons">
                            <f:ajax render=":accounts"/>
                        </p:commandButton>
                    </div>
                </f:facet>
            </p:dataTable>
            <p:messages for="accountsTable" style="color:red" />
        </h:form>
    </div>
</ui:composition>

